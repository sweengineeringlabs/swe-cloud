//! Cloudemu API tests.
//!
//! API integration tests for cloudemu feature.
//! Generated by `rsc scaffold services`

use rustscript::test::*;
use rustscript::http::*;
use crate::api::*;

#[tokio::test]
async fn cloudemu_api_client_initializes() {
    let client = CloudemuClient::new();
    assert!(client.is_ready().await);
}

#[tokio::test]
async fn cloudemu_list_resources() {
    let client = CloudemuClient::new();
    let mock = CloudemuClientMock::new()
        .with_response("list", vec![]);

    let result = mock.list(Default::default()).await;
    assert!(result.is_ok());
}

#[tokio::test]
async fn cloudemu_get_resource() {
    let mock = CloudemuClientMock::new()
        .with_response("get", Default::default());

    let result = mock.get("test-id".to_string()).await;
    assert!(result.is_ok());
}

#[tokio::test]
async fn cloudemu_create_resource() {
    let mock = CloudemuClientMock::new()
        .with_response("create", Default::default());

    let result = mock.create(Default::default()).await;
    assert!(result.is_ok());
    assert!(mock.was_called("create"));
}

#[tokio::test]
async fn cloudemu_delete_resource() {
    let mock = CloudemuClientMock::new()
        .with_response("delete", ());

    let result = mock.delete("test-id".to_string()).await;
    assert!(result.is_ok());
}

#[tokio::test]
async fn cloudemu_handles_api_error() {
    let mock = CloudemuClientMock::new()
        .with_error("get", ApiError::NotFound);

    let result = mock.get("nonexistent".to_string()).await;
    assert!(result.is_err());
}
